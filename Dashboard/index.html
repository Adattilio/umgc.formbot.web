<!DOCTYPE html>
<html>
<head>
    <title>FormBot Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="ASSETS/font-awesome-4.7.0/css/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="STYLES/master.css">
    <link type="text/css" rel="stylesheet" href="STYLES/theme.css">
    <link type="text/css" rel="stylesheet" href="STYLES/print.css">

    <!-- TESXT DATA -->
    <script src="TEST-DATA/GetFormList.JS"></script>
    <script src="TEST-DATA/GetReportList.JS"></script>
    <script src="TEST-DATA/GetUserList.JS"></script>
    <script src="TEST-DATA/GetFormDetails2.JS"></script>
    <script src="TEST-DATA/GetReportDetails231.JS"></script>
    <script src="TEST-DATA/GetHelpArticleList.JS"></script>

    <!-- THis si the development version of vue, when we go live we will change this to the production -->
    <script src="ASSETS/vue.js"></script>
    <!-- MOments is a light weight quic way of handling dates: https://momentjs.com/-->
    <script src="ASSETS/moment-with-locales.min.js"></script>
    <!-- Axios is used to send request and recive response with rest: https://github.com/axios/axios-->
    <!-- TODO: activate once web service is up
        <script src="ASSETS/axios.min.js"></script> -->
    <!-- Vue Grid goives us a drag and drap capability for adjusting layouts -->
    <script src="ASSETS/vue-grid-layout.umd.min.js"></script>
</head>
<body>


<main id="dashboard" class="app">
    <header class="main">
        <h1>{{title}}</h1>
        <nav>
            <div class="tab" v-on:click="toggleTabs(0)">About & Help Docs</div>
            <div class="tab" v-on:click="toggleTabs(1)">Forms</div>
            <div class="tab" v-on:click="toggleTabs(2)">Completed Forms</div>
            <div class="tab" v-on:click="toggleTabs(3)" v-if="currentUser.role">Users</div>
        </nav>
    </header>
    <article id="about" v-if="showManager == 0">
        <Section>
            <header>About the Dashboard</header>
            {{about}}
        </Section>
        <section>
            <header>Help Articles</header>
            <help-articles-list
                :list="helpArticleList"
                :filter-key="filterKey.helpArticles">
            </help-articles-list>
        </section>
    </article>

    <article class="pannel" id="formManager" v-if="showManager == 1">
        <header class="title">
            Form Manager
        </header>
        <section class="list">
            <header class="title">Forms</header>
            <input v-model="filterKey.forms" class="form-control" placeholder=" Input Search name, department, or work location"/>
            <div class="btn" @click="openFormEditor('create','')">Create New Form</div>
            <form-list
                @openformreader="openForm($event)"
                @openformeditor="openFormEditor('edit',$event)"
                :list="formList"
                :filter-key="filterKey.forms">
            </form-list>
        </section>
        <section class="editor display">
            <article v-if="showEditor.form">
              <header>
                <h2>Editor</h2>
                <div class="btn" @click="addField">Add</div>
              </header>
              <section id="editMetaData" class="cf" > 
                  <section class="left form">
                    <header>Form Details</header>
                    <label>Form Name</label><input v-model="form.name"/><br/>
                    <lable>Description</lable><textarea v-model="form.description"></textarea>
                  </section>
                  <section class="left field" v-if="formFieldMetaData.show">
                    <header>Field Metadata</header>
                    <label>Field Name:</label><input v-model="formFieldMetaData.name"/><br/>
                    <!-- TODO: create valdiation call for unique name-->
                    <lable>Field Description:</lable><textarea v-model="formFieldMetaData.description"></textarea><br/>
                    <label>Field Type:</label><select v-model="formFieldMetaData.type">
                        <option value="null">Select a field type...</option>
                        <option value="input">Input</option>
                        <option value="textarea">Textarea</option>
                    </select><br/>
                    <label>Required</label><input type="checkbox" id="checkbox" v-model="formFieldMetaData.required"><br/>
                    <div class="btn" @click="saveFieldMetaData(formFieldMetaData.i)">Update Field</div>
                  </section> 
              </section>
              <section class="layout">
                <grid-layout
                    :layout.sync="form.fields"
                    :col-num="12"
                    :row-height="30"
                    :is-draggable="true"
                    :is-resizable="true"
                    :is-mirrored="false"
                    :vertical-compact="true"
                    :margin="[10, 10]"
                    :use-css-transforms="true"
                >
            
                    <grid-item 
                    v-for="field in form.fields"
                    :x="field.x"
                    :y="field.y"
                    :w="field.w"
                    :h="field.h"
                    :i="field.i">
                        {{field.name}}
                        <div class="btn" @click="editFormFieldMetaData(field.i)" v-bind:title="'Edit field '+ field.name">
                            <i class="fa fa-pencil" aria-hidden="true"></i>
                        </div>
                        <div class="btn" @click="removeField(field.i)" v-bind:title="'Delete field '+ field.name">
                            <i class="fa fa-trash" aria-hidden="true" ></i></div>
                    </grid-item>
                </grid-layout>
            </section>
            </article>
        </section>
    </article>
                    
    <article class="pannel" id="reportManager" v-if="showManager == 2">
        <header class="title">
            Reports Manager
        </header>
        <section class="list left">
            <input v-model="filterKey.reports" class="form-control" placeholder=" Input Search name, department, or work location"/>
            <report-list
                @openreportreader="openReportEditor($event)"
                :list="reportList"
                :filter-key="filterKey.reports">
            </report-list>
        </section>
        <section class="editor left">
            <article v-if="showEditor.report">
                <grid-layout
                    :layout.sync="report.fields"
                    :col-num="12"
                    :row-height="30"
                    :is-draggable="false"
                    :is-resizable="false"
                    :is-mirrored="false"
                    :vertical-compact="true"
                    :margin="[10, 10]"
                    :use-css-transforms="true"
                >
                    <grid-item 
                    v-for="r in report.fields"
                    :x="r.x"
                    :y="r.y"
                    :w="r.w"
                    :h="r.h"
                    :i="r.i">
                        {{r.name}}<br/>
                        <input v-model="r.value"/>
                    </grid-item>
                </grid-layout>
            </article>
        </section>
    </article>

    <article  class="pannel" id="userManager" v-if="showManager == 3">
        <header class="title">Users Manager</header>
        <section class="list">
            <input v-model="filterKey.users" class="form-control" placeholder=" Input Search name, department, or work location"/>
            <user-list
                @open-my-form="openForm($event)"
                :list="userList"
                :filter-key="filterKey.users">
            </user-list>
        </section>
        <section class="editor"></section>
    </article>
</main>

<!-- Add link to your component here -->
<script src="COMPONENTS/formList.component.js"></script>
<script src="COMPONENTS/FormEditor.component.js"></script>
<script src="COMPONENTS/reportList.component.js"></script>
<script src="COMPONENTS/userList.component.js"></script>

<!-- Loading vue core-->
<script src="vue.core.js"></script>
</body>
</html>